<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéæ Tennis Buddy Scheduler</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Kanit', sans-serif;
        }
        
        .tennis-green {
            background: linear-gradient(135deg, #2D6E3B, #3D8B4E);
        }
        
        .time-slot {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .time-slot:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(45, 110, 59, 0.3);
        }
        
        .available {
            background: #D1FAE5;
            border: 2px solid #10B981;
            color: #065F46;
        }
        
        .selected {
            background: #3B82F6;
            border: 2px solid #1D4ED8;
            color: white;
        }
        
        .unavailable {
            background: #FEE2E2;
            border: 2px solid #EF4444;
            color: #991B1B;
        }
        
        .pulse-tennis {
            animation: pulse-tennis 2s infinite;
        }
        
        @keyframes pulse-tennis {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <div class="tennis-green text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-3xl font-bold mb-2">
                <span class="pulse-tennis inline-block">üéæ</span> 
                Tennis Buddy Scheduler
                <span class="pulse-tennis inline-block">üéæ</span>
            </h1>
            <p class="text-green-100">‡∏´‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏î‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏ó‡∏ô‡∏ô‡∏¥‡∏™‡∏Å‡∏±‡∏ô!</p>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- User Input Section -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <div class="flex items-center mb-4">
                <i class="fas fa-user-circle text-green-600 text-2xl mr-3"></i>
                <h2 class="text-xl font-semibold">‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            </div>
            <div class="flex gap-4 items-center flex-wrap">
                <input 
                    type="text" 
                    id="userName" 
                    placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."
                    class="flex-1 min-w-60 px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:outline-none text-lg"
                >
                <button 
                    onclick="setUser()"
                    class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors"
                >
                    <i class="fas fa-check mr-2"></i>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠
                </button>
            </div>
        </div>

        <!-- Current User Display -->
        <div id="currentUserDisplay" class="hidden bg-blue-50 border-l-4 border-blue-400 p-4 mb-8 rounded">
            <div class="flex items-center">
                <i class="fas fa-user text-blue-600 mr-3"></i>
                <span class="font-medium">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ</span>
                <span id="displayUserName" class="font-bold text-blue-600 ml-2"></span>
                <span class="ml-2">! ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ üëá</span>
            </div>
        </div>

        <!-- Calendar Section -->
        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Week 1 -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-calendar-week text-green-600 mr-3"></i>
                    ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 3 (15-21 ‡∏Å.‡∏¢. 2568)
                </h3>
                <div id="week1" class="space-y-4">
                    <!-- Week 1 will be generated by JavaScript -->
                </div>
            </div>

            <!-- Week 2 -->
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-calendar-week text-green-600 mr-3"></i>
                    ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 4-5 (22-30 ‡∏Å.‡∏¢. 2568)
                </h3>
                <div id="week2" class="space-y-4">
                    <!-- Week 2 will be generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mt-8">
            <div class="flex flex-wrap gap-4 justify-center">
                <button onclick="clearAll()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                    <i class="fas fa-trash mr-2"></i>‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
                <button onclick="saveSelection()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                    <i class="fas fa-save mr-2"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                </button>
                <button onclick="viewResults()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                    <i class="fas fa-chart-bar mr-2"></i>‡∏î‡∏π‡∏ú‡∏•‡∏£‡∏ß‡∏°
                </button>
                <button onclick="exportResults()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                    <i class="fas fa-download mr-2"></i>Export ‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏£‡∏∏‡πä‡∏õ
                </button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden mt-8">
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-trophy text-yellow-500 mr-3"></i>
                    ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤
                </h3>
                <div id="resultsContent">
                    <!-- Results will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mt-8">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fas fa-info-circle text-blue-500 mr-3"></i>
                ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏µ
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded available"></div>
                    <span>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded selected"></div>
                    <span>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß (‡∏ß‡πà‡∏≤‡∏á)</span>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded unavailable"></div>
                    <span>‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = '';
        let userSelections = JSON.parse(localStorage.getItem('tennisSchedule') || '{}');

        // Generate calendar
        function generateCalendar() {
            const week1Dates = [
                {date: '15/9', day: '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', type: 'weekday'},
                {date: '16/9', day: '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', type: 'weekday'},
                {date: '17/9', day: '‡∏û‡∏∏‡∏ò', type: 'weekday'},
                {date: '18/9', day: '‡∏û‡∏§‡∏´‡∏±‡∏™', type: 'weekday'},
                {date: '19/9', day: '‡∏®‡∏∏‡∏Å‡∏£‡πå', type: 'weekday'},
                {date: '20/9', day: '‡πÄ‡∏™‡∏≤‡∏£‡πå', type: 'weekend'},
                {date: '21/9', day: '‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', type: 'weekend'}
            ];

            const week2Dates = [
                {date: '22/9', day: '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', type: 'weekday'},
                {date: '23/9', day: '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', type: 'weekday'},
                {date: '24/9', day: '‡∏û‡∏∏‡∏ò', type: 'weekday'},
                {date: '25/9', day: '‡∏û‡∏§‡∏´‡∏±‡∏™', type: 'weekday'},
                {date: '26/9', day: '‡∏®‡∏∏‡∏Å‡∏£‡πå', type: 'weekday'},
                {date: '27/9', day: '‡πÄ‡∏™‡∏≤‡∏£‡πå', type: 'weekend'},
                {date: '28/9', day: '‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', type: 'weekend'},
                {date: '29/9', day: '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', type: 'weekday'},
                {date: '30/9', day: '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', type: 'weekday'}
            ];

            generateWeek('week1', week1Dates);
            generateWeek('week2', week2Dates);
        }

        function generateWeek(containerId, dates) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            dates.forEach(dateInfo => {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'border-b border-gray-200 pb-4';

                const times = dateInfo.type === 'weekend' 
                    ? ['06:00-08:00', '17:00-19:00', '19:00-21:00', '21:00-23:00']
                    : ['19:00-21:00', '21:00-23:00'];

                let dayHTML = `
                    <div class="font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm mr-2">
                            ${dateInfo.date}
                        </span>
                        ${dateInfo.day}
                        ${dateInfo.type === 'weekend' ? 'üèñÔ∏è' : 'üíº'}
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                `;

                times.forEach(time => {
                    const slotId = `${dateInfo.date}-${time}`;
                    dayHTML += `
                        <button 
                            id="${slotId}"
                            onclick="toggleTimeSlot('${slotId}')"
                            class="time-slot available p-3 rounded-lg text-sm font-medium text-center"
                        >
                            ‚è∞ ${time}
                        </button>
                    `;
                });

                dayHTML += '</div>';
                dayDiv.innerHTML = dayHTML;
                container.appendChild(dayDiv);
            });
        }

        function setUser() {
            const userName = document.getElementById('userName').value.trim();
            if (!userName) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
                return;
            }

            currentUser = userName;
            document.getElementById('displayUserName').textContent = userName;
            document.getElementById('currentUserDisplay').classList.remove('hidden');

            // Initialize user selections if not exists
            if (!userSelections[currentUser]) {
                userSelections[currentUser] = {};
            }

            updateCalendarDisplay();
        }

        function toggleTimeSlot(slotId) {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            const slot = document.getElementById(slotId);
            const currentStatus = userSelections[currentUser][slotId];

            // Cycle through: undefined -> selected -> unavailable -> selected
            if (!currentStatus || currentStatus === 'unavailable') {
                userSelections[currentUser][slotId] = 'selected';
                slot.className = 'time-slot selected p-3 rounded-lg text-sm font-medium text-center';
                slot.innerHTML = slot.innerHTML.replace('‚è∞', '‚úÖ');
            } else if (currentStatus === 'selected') {
                userSelections[currentUser][slotId] = 'unavailable';
                slot.className = 'time-slot unavailable p-3 rounded-lg text-sm font-medium text-center';
                slot.innerHTML = slot.innerHTML.replace('‚úÖ', '‚ùå');
            }

            saveToLocalStorage();
        }

        function updateCalendarDisplay() {
            if (!currentUser || !userSelections[currentUser]) return;

            Object.keys(userSelections[currentUser]).forEach(slotId => {
                const slot = document.getElementById(slotId);
                if (!slot) return;

                const status = userSelections[currentUser][slotId];
                if (status === 'selected') {
                    slot.className = 'time-slot selected p-3 rounded-lg text-sm font-medium text-center';
                    slot.innerHTML = slot.innerHTML.replace('‚è∞', '‚úÖ');
                } else if (status === 'unavailable') {
                    slot.className = 'time-slot unavailable p-3 rounded-lg text-sm font-medium text-center';
                    slot.innerHTML = slot.innerHTML.replace('‚è∞', '‚ùå');
                }
            });
        }

        function clearAll() {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                userSelections[currentUser] = {};
                saveToLocalStorage();
                
                // Reset all slots to available
                const allSlots = document.querySelectorAll('.time-slot');
                allSlots.forEach(slot => {
                    slot.className = 'time-slot available p-3 rounded-lg text-sm font-medium text-center';
                    slot.innerHTML = slot.innerHTML.replace(/[‚úÖ‚ùå]/, '‚è∞');
                });
            }
        }

        function saveSelection() {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            saveToLocalStorage();
            alert(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á ${currentUser} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! üéæ`);
        }

        function saveToLocalStorage() {
            localStorage.setItem('tennisSchedule', JSON.stringify(userSelections));
        }

        function viewResults() {
            const resultsSection = document.getElementById('resultsSection');
            const resultsContent = document.getElementById('resultsContent');

            // Count selections for each time slot
            const slotCounts = {};
            const usersList = Object.keys(userSelections);

            // Get all possible time slots
            const allSlots = document.querySelectorAll('.time-slot');
            allSlots.forEach(slot => {
                const slotId = slot.id;
                slotCounts[slotId] = {
                    available: [],
                    unavailable: [],
                    total: usersList.length
                };
            });

            // Count each user's selections
            usersList.forEach(user => {
                Object.keys(slotCounts).forEach(slotId => {
                    const userChoice = userSelections[user][slotId];
                    if (userChoice === 'selected') {
                        slotCounts[slotId].available.push(user);
                    } else if (userChoice === 'unavailable') {
                        slotCounts[slotId].unavailable.push(user);
                    }
                });
            });

            // Generate results HTML
            let resultsHTML = `
                <div class="mb-6">
                    <h4 class="text-lg font-semibold text-gray-700 mb-3">
                        <i class="fas fa-users text-blue-500 mr-2"></i>
                        ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß: ${usersList.length} ‡∏Ñ‡∏ô
                    </h4>
                    <div class="flex flex-wrap gap-2">
                        ${usersList.map(user => `
                            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                                ${user}
                            </span>
                        `).join('')}
                    </div>
                </div>
            `;

            // Find best time slots (most people available)
            const bestSlots = Object.entries(slotCounts)
                .filter(([_, data]) => data.available.length > 0)
                .sort((a, b) => b[1].available.length - a[1].available.length)
                .slice(0, 5);

            if (bestSlots.length > 0) {
                resultsHTML += `
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-green-700 mb-3">
                            <i class="fas fa-star text-yellow-500 mr-2"></i>
                            ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á)
                        </h4>
                        <div class="space-y-2">
                            ${bestSlots.map(([slotId, data]) => {
                                const [date, time] = slotId.split('-');
                                return `
                                    <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium text-green-800">
                                                üìÖ ${date} ‡πÄ‡∏ß‡∏•‡∏≤ ${time}
                                            </span>
                                            <span class="bg-green-500 text-white px-2 py-1 rounded text-sm">
                                                ${data.available.length}/${usersList.length} ‡∏Ñ‡∏ô
                                            </span>
                                        </div>
                                        <div class="text-sm text-green-700">
                                            <strong>‡∏ß‡πà‡∏≤‡∏á:</strong> ${data.available.join(', ')}
                                            ${data.unavailable.length > 0 ? `<br><strong>‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á:</strong> ${data.unavailable.join(', ')}` : ''}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            } else {
                resultsHTML += `
                    <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg mb-6">
                        <p class="text-yellow-800">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á ‡∏•‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡πÉ‡∏´‡πâ‡∏°‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏±‡∏ô!
                        </p>
                    </div>
                `;
            }

            resultsContent.innerHTML = resultsHTML;
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function exportResults() {
            const usersList = Object.keys(userSelections);
            if (usersList.length === 0) {
                alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤');
                return;
            }

            // Count selections for each time slot
            const slotCounts = {};
            const allSlots = document.querySelectorAll('.time-slot');
            
            allSlots.forEach(slot => {
                const slotId = slot.id;
                slotCounts[slotId] = {
                    available: [],
                    unavailable: []
                };
            });

            usersList.forEach(user => {
                Object.keys(slotCounts).forEach(slotId => {
                    const userChoice = userSelections[user][slotId];
                    if (userChoice === 'selected') {
                        slotCounts[slotId].available.push(user);
                    } else if (userChoice === 'unavailable') {
                        slotCounts[slotId].unavailable.push(user);
                    }
                });
            });

            // Find best time slots
            const bestSlots = Object.entries(slotCounts)
                .filter(([_, data]) => data.available.length > 0)
                .sort((a, b) => b[1].available.length - a[1].available.length);

            let exportText = `üéæ Tennis Schedule Results üéæ\n\n`;
            exportText += `‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß: ${usersList.join(', ')} (${usersList.length} ‡∏Ñ‡∏ô)\n\n`;
            
            if (bestSlots.length > 0) {
                exportText += `‚≠ê ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:\n\n`;
                bestSlots.slice(0, 3).forEach(([slotId, data], index) => {
                    const [date, time] = slotId.split('-');
                    exportText += `${index + 1}. üìÖ ${date} ‚è∞ ${time}\n`;
                    exportText += `   ‡∏ß‡πà‡∏≤‡∏á: ${data.available.join(', ')} (${data.available.length} ‡∏Ñ‡∏ô)\n`;
                    if (data.unavailable.length > 0) {
                        exportText += `   ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á: ${data.unavailable.join(', ')}\n`;
                    }
                    exportText += `\n`;
                });
            } else {
                exportText += `‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô\n\n`;
            }

            exportText += `\nüîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô:\n${window.location.href}`;

            // Copy to clipboard
            navigator.clipboard.writeText(exportText).then(() => {
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏£‡∏∏‡πä‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ üìã');
            }).catch(() => {
                // Fallback for browsers that don't support clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = exportText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏£‡∏∏‡πä‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ üìã');
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            generateCalendar();
        });
    </script>
</body>
</html>